<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body onload="Setup()">
     <div id="content">
        <div>
          <input type="file" accept="image/*" id="imagePicker">
        </div>
        <div id="image">
          <canvas id="canvas" width="256" height="256" style="display:none"></canvas>
          <canvas id="newcanvas" width="256" height="256"></canvas>
        </div>
        <div>
          <input type="button" value="Previous">
          <input type="button" onclick="drawPhotomaton()" value="Next">
        </div>
     </div>
  </body>
  <script type="text/javascript">
    var img;
    var canvas;
    var newCanvas;
    const SLEEP_TIME = 50;
    
    function Setup(){
        img = new Image();
        img.src="./image.jpg";
        canvas = document.getElementById('canvas');
        canvas.getContext('2d').drawImage(img, 0, 0)
        newCanvas = document.getElementById('newcanvas');
        newCanvas.getContext('2d').drawImage(img,0,0);
    }
    

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    function getBase64Image(img) {
        var canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        var ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);
        var dataURL = canvas.toDataURL("image/png");

        return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
    }

    async function CallAlgorithm(pAlgorithm){
      do{
        
        await sleep(100);
      }while (getBase64Image(img) != getBase64Image(newCanvas));
    }

 


    function twist() 
    {
      console.log("click");
      let width = 256;
      let height = 256;
      for (let y of Array(height).keys()) {
          for (let x of Array(width).keys()) {

              var ctx = canvas.getContext('2d');
              var newCtx = newCanvas.getContext('2d');
              var pixelData = ctx.getImageData(x, y, 1, 1);
              var newX = x;
              var newY = y;
              
              newX = x+1;
              newY = y+1;

              newCtx.putImageData(pixelData, newX, newY)

              }
        }
      canvas.getContext('2d').drawImage(newCanvas, 0, 0);
    }

   

      

  </script>
  <script type="text/javascript" src="Processing.js"></script>
  <!-- <script type="text/javascript" src="ToolsImages.js"></script> -->
</html>
